# 🗺️ ВИЗУАЛЬНАЯ КАРТА ПРОЕКТА - IESA_ROOT

**Версия:** 1.0 | **Дата:** 28 декабря 2025

---

## 📊 АРХИТЕКТУРА СИСТЕМЫ

```
┌─────────────────────────────────────────────────────────────┐
│                   🌐 БРАУЗЕР ПОЛЬЗОВАТЕЛЯ                    │
│                                                              │
│  http://localhost:8000  (Django Development Server)        │
└──────────────────────┬──────────────────────────────────────┘
                       │
         ┌─────────────┴──────────────┐
         │                            │
         ▼                            ▼
    🎨 FRONTEND                   🔧 BACKEND
┌──────────────────┐         ┌──────────────────┐
│ HTML Templates   │         │ Django Framework │
│ Bootstrap 5.3    │         │ Python 3.11      │
│ HTMX 1.9.12      │         │ SQLite DB        │
│ FontAwesome 6    │         └──────────────────┘
│ CKEditor 5       │                 │
└──────────────────┘                 │
         │                           │
         └───────────────┬───────────┘
                         │
         ┌───────────────┴──────────────┐
         │                              │
         ▼                              ▼
    📁 СТАТИКА                    💾 ДАННЫЕ
  CSS, JS, IMG                  Database.sqlite3
                                    (26+ records)
```

---

## 🏗️ АРХИТЕКТУРА DJANGO

```
IESA_ROOT/
│
├── 🔧 CORE SETTINGS (IESA_ROOT/)
│   ├── settings.py ─────────────► Конфигурация всего проекта
│   ├── urls.py ────────────────► Главные маршруты
│   ├── wsgi.py ────────────────► Production запуск
│   └── asgi.py ────────────────► Async запуск
│
├── 👥 APP: users/ ─────────► Управление пользователями
│   ├── models.py ───────────► User модель + get_achievement_level()
│   ├── views.py ───────────► Регистрация, профиль, уровни ⭐
│   ├── urls.py ────────────► /auth/* маршруты
│   ├── forms.py ───────────► Формы регистрации/входа
│   └── templates/ ─────────► 5+ шаблонов
│
├── 📰 APP: blog/ ──────────► Блог с постами и событиями
│   ├── models.py ───────────► Post, Comment, Event
│   ├── views.py ───────────► Отображение постов
│   ├── urls.py ────────────► /blog/* маршруты
│   └── templates/ ─────────► post_list, partners.html ⭐
│
├── 🛍️ APP: products/ ─────► Каталог товаров
│   ├── models.py ───────────► Product модель
│   ├── views.py ───────────► Отображение товаров
│   └── urls.py ────────────► /products/* маршруты
│
├── 🖼️ APP: gallery/ ──────► Галерея фотографий
│   ├── models.py ───────────► Gallery, Photo модели
│   ├── views.py ───────────► Отображение галереи
│   └── urls.py ────────────► /gallery/* маршруты
│
└── 🎯 APP: core/ ─────────► Основной функционал
    ├── models.py ───────────► Partner (+ contract field ⭐), Member
    ├── views.py ───────────► Главная страница
    └── urls.py ────────────► / маршруты
```

---

## 📋 ПРОЦЕСС ЗАПРОСА (Request Flow)

```
1️⃣ ЗАПРОС БРАУЗЕРА
   └─► GET http://localhost:8000/blog/

2️⃣ МАРШРУТИЗАЦИЯ
   IESA_ROOT/urls.py
   └─► Находит: path('blog/', include('blog.urls'))
       blog/urls.py
       └─► Находит: path('', views.post_list, name='post_list')

3️⃣ ПРЕДСТАВЛЕНИЕ (VIEW)
   blog/views.py
   └─► post_list(request)
       ├─► Запрос к БД: Post.objects.filter(published=True)
       ├─► Получает данные
       └─► Подготавливает контекст

4️⃣ ШАБЛОН (TEMPLATE)
   templates/blog/post_list.html
   └─► {% for post in posts %}
       ├─► Отображает данные
       ├─► Использует CSS стили
       └─► Включает HTMX компоненты

5️⃣ ОТВЕТ БРАУЗЕРУ
   └─► HTML страница + CSS + JS
       └─► Браузер рендерит

6️⃣ ИНТЕРАКТИВНОСТЬ (HTMX)
   └─► Клик по кнопке "View Details"
       └─► partner_modal.html загружается через AJAX
           └─► Показывает модаль с контрактом ⭐
```

---

## 🗄️ МОДЕЛЬ ДАННЫХ (Entity-Relationship)

```
┌──────────────┐       ┌──────────────┐
│ 👥 USER      │       │ 📰 POST      │
├──────────────┤       ├──────────────┤
│ id (PK)      │◄──────│ id (PK)      │
│ username     │       │ title        │
│ email        │       │ content      │
│ points       │       │ author_id (FK)
│ avatar       │       │ published    │
│ bio          │       └──────────────┘
│ ...          │              │
└──────────────┘              │
        │                     ├─► ┌──────────────┐
        │                     │   │ 💬 COMMENT   │
        │                     │   ├──────────────┤
        │                     │   │ id (PK)      │
        └─────────────────────┼───│ text         │
                              │   │ post_id (FK) │
                              │   │ author_id(FK)│
                              │   └──────────────┘
                              └─► ┌──────────────┐
                                  │ 👍 LIKE      │
                                  ├──────────────┤
                                  │ id (PK)      │
                                  │ post_id (FK) │
                                  │ user_id (FK) │
                                  └──────────────┘

┌──────────────┐       ┌──────────────┐
│ 🤝 PARTNER   │       │ 📦 EVENT     │
├──────────────┤       ├──────────────┤
│ id (PK)      │       │ id (PK)      │
│ name         │       │ title        │
│ description  │       │ date         │
│ logo         │       │ description  │
│ contract ⭐  │       │ image        │
│ website      │       └──────────────┘
└──────────────┘

┌──────────────┐       ┌──────────────┐
│ 🛍️ PRODUCT   │       │ 🖼️ GALLERY   │
├──────────────┤       ├──────────────┤
│ id (PK)      │       │ id (PK)      │
│ name         │       │ title        │
│ description  │       │ description  │
│ price        │       └──────────────┘
│ image        │            │
└──────────────┘            ├─► ┌──────────────┐
                            │   │ 📷 PHOTO     │
                            │   ├──────────────┤
                            │   │ id (PK)      │
                            │   │ image        │
                            │   │ gallery_id(FK)
                            │   └──────────────┘
```

---

## 🔄 ЖИЗНЕННЫЙ ЦИКЛ ПОЛЬЗОВАТЕЛЯ

```
1️⃣ РЕГИСТРАЦИЯ
   └─► http://localhost:8000/auth/register/
       ├─► Форма: username, email, password
       ├─► Валидация
       ├─► Сохранение в БД
       └─► Редирект на login

2️⃣ ВХОД
   └─► http://localhost:8000/auth/login/
       ├─► Форма: email, password
       ├─► Проверка credentials
       ├─► Создание сессии
       └─► Редирект на профиль

3️⃣ ПРОФИЛЬ
   └─► http://localhost:8000/auth/profile/
       ├─► Показывает информацию пользователя
       ├─► Отображает уровень активности ⭐
       ├─► Показывает статистику (posts, comments)
       └─► Кнопка редактирования

4️⃣ АКТИВНОСТЬ
   ├─► Создание поста: +10 очков ⭐
   ├─► Создание комментария: +1 очко ⭐
   └─► Получение лайка: +2 очка ⭐
       └─► Уровень пересчитывается автоматически

5️⃣ ИНФОРМАЦИЯ ОБ УРОВНЯХ
   └─► http://localhost:8000/auth/activity-levels/
       ├─► 5 уровней: Beginner → Legend
       ├─► Очки для каждого уровня
       ├─► Советы по продвижению
       └─► Система объяснена

6️⃣ ВЫХОД
   └─► Нажать логаут
       └─► Сессия удаляется
```

---

## 🎨 ПОЛЬЗОВАТЕЛЬСКИЙ ИНТЕРФЕЙС (UI Flow)

```
┌──────────────────────────────────────────────────┐
│           🌐 ГЛАВНАЯ СТРАНИЦА                    │
│  http://localhost:8000/                          │
├──────────────────────────────────────────────────┤
│  [Logo] [Navigation Menu]          [Login] [Sign Up] │
├──────────────────────────────────────────────────┤
│                    📺 HERO SECTION               │
│              Добро пожаловать в IESA!            │
├──────────────────────────────────────────────────┤
│          🤝 ПАРТНЕРЫ (Redesigned ⭐)           │
│  ┌────────────┐ ┌────────────┐ ┌────────────┐   │
│  │ SportTech  │ │ EliteFit   │ │ Nutrition  │   │
│  │ [Logo]     │ │ [Logo]     │ │ [Logo]     │   │
│  │ Desc...    │ │ Desc...    │ │ Desc...    │   │
│  │[Details]⭐ │ │[Details]⭐ │ │[Details]⭐ │   │
│  └────────────┘ └────────────┘ └────────────┘   │
├──────────────────────────────────────────────────┤
│         📰 ПОСЛЕДНИЕ ПОСТЫ | 🛍️ ТОВАРЫ        │
├──────────────────────────────────────────────────┤
│              📍 ПОДВАЛ (Footer)                  │
└──────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────┐
│        👥 ПРОФИЛЬ ПОЛЬЗОВАТЕЛЯ                   │
│   http://localhost:8000/auth/profile/            │
├──────────────────────────────────────────────────┤
│  [Avatar] Имя | [Редактировать]                 │
├──────────────────────────────────────────────────┤
│         🎖️ УРОВЕНЬ АКТИВНОСТИ ⭐               │
│  ┌────────────────────────────────────────┐     │
│  │ 🚀 Advanced Level                      │     │
│  │ 385 / 500 очков                        │     │
│  │ [Learn More →]                         │     │
│  └────────────────────────────────────────┘     │
├──────────────────────────────────────────────────┤
│  📊 Статистика: Посты: 5 | Лайки: 12 | ...     │
├──────────────────────────────────────────────────┤
│           📝 МОИ ПОСТЫ (список)                  │
└──────────────────────────────────────────────────┘

┌──────────────────────────────────────────────────┐
│      🎯 ИНФОРМАЦИЯ ОБ УРОВНЯХ                    │
│   http://localhost:8000/auth/activity-levels/    │
├──────────────────────────────────────────────────┤
│  КАК ПОЛУЧИТЬ БОЛЬШЕ УРОВНЕЙ?                  │
├──────────────────────────────────────────────────┤
│  📝 Пост = +10 очков                            │
│  💬 Комментарий = +1 очко                       │
│  👍 Лайк = +2 очка                              │
├──────────────────────────────────────────────────┤
│  5 УРОВНЕЙ:                                     │
│  🍃 Beginner (0-50)                             │
│  🔥 Intermediate (50-200)                       │
│  🚀 Advanced (200-500)                          │
│  ⭐ Expert (500-1000)                           │
│  👑 Legend (1000+)                              │
└──────────────────────────────────────────────────┘
```

---

## 🔗 НАВИГАЦИЯ МЕЖДУ СТРАНИЦАМИ

```
HOME (/)
├─► /auth/login/ ─────────► вход
│   └─► /auth/register/ ──► регистрация
├─► /auth/profile/ ───────► профиль (protected)
│   └─► /auth/profile/edit/ ─► редактирование (protected)
├─► /auth/activity-levels/ ─► информация об уровнях ⭐
├─► /blog/ ─────────────────► список постов
│   ├─► /blog/<id>/ ─────────► детали поста
│   └─► /blog/post/new/ ────► создание поста (protected)
├─► /products/ ─────────────► список товаров
├─► /gallery/ ──────────────► галерея фотографий
└─► /admin/ ────────────────► админ-панель (protected)
    ├─► Users
    ├─► Partners (add, edit, delete) ⭐
    ├─► Posts
    ├─► Events
    ├─► Products
    └─► Gallery
```

---

## 📦 ЗАГРУЗКА ФАЙЛОВ (Upload Flow)

```
ПОЛЬЗОВАТЕЛЬ
    │
    ▼
┌─────────────────────────────┐
│ Форма загрузки файла        │
│ ├─ Логотип партнера (img)   │
│ ├─ Контракт партнера (img)⭐│
│ ├─ Аватар пользователя      │
│ └─ Превью поста             │
└─────────────────┬───────────┘
                  │
                  ▼
        ┌─────────────────────┐
        │ Валидация файла     │
        │ ├─ Тип файла ✓      │
        │ ├─ Размер ✓         │
        │ └─ Вирусы ✓         │
        └─────────────────────┘
                  │
                  ▼
        ┌─────────────────────┐
        │ Сохранение          │
        │ media/              │
        │ ├─ partners/        │
        │ │  ├─ logos/        │
        │ │  └─ contracts/⭐  │
        │ ├─ avatars/         │
        │ └─ blog/previews/   │
        └─────────────────────┘
                  │
                  ▼
        ┌─────────────────────┐
        │ Отображение         │
        │ HTML: <img src>     │
        └─────────────────────┘
```

---

## 🔐 БЕЗОПАСНОСТЬ (Security Layers)

```
┌────────────────────────────────┐
│ 1. CSRF PROTECTION             │
│    {% csrf_token %} в формах   │
└────────────────────────────────┘
            │
            ▼
┌────────────────────────────────┐
│ 2. SQL INJECTION PROTECTION   │
│    ORM (никогда raw SQL)       │
└────────────────────────────────┘
            │
            ▼
┌────────────────────────────────┐
│ 3. XSS PROTECTION              │
│    {{ variable }} автоescapes   │
└────────────────────────────────┘
            │
            ▼
┌────────────────────────────────┐
│ 4. AUTHENTICATION              │
│    login_required декоратор    │
└────────────────────────────────┘
            │
            ▼
┌────────────────────────────────┐
│ 5. AUTHORIZATION               │
│    Проверка прав доступа       │
└────────────────────────────────┘
            │
            ▼
┌────────────────────────────────┐
│ 6. VALIDATION                  │
│    Django Forms & validators   │
└────────────────────────────────┘
```

---

## ⚡ ПРОИЗВОДИТЕЛЬНОСТЬ (Performance)

```
БРАУЗЕР
   │
   ├─► CSS (Static) ─────► Кэш браузера (1 год)
   ├─► JS (Static) ──────► Кэш браузера (1 год)
   ├─► IMG (Static) ─────► Кэш браузера (1 год)
   │
   └─► HTML (Dynamic) ──► Сервер
        │
        ├─► БД Query ─────► SELECT * FROM posts WHERE published=1
        ├─► Шаблон ───────► Рендеринг
        └─► Response ─────► Браузер

ОПТИМИЗАЦИЯ:
✅ Кэширование статики
✅ Индексы в БД (на id, published, author_id)
✅ Lazy loading изображений
✅ Минификация CSS/JS (CDN)
✅ HTMX для partial updates (не полная перезагрузка)
```

---

## 🔄 МИГРАЦИИ БД (Database Migrations)

```
V 1.0 (Starting point)
│
├─ 0001_initial.py ─────────► Создание основных таблиц
│  ├─ User
│  ├─ Post
│  └─ ...
│
├─ 0002_*.py ───────────────► Обновления (Discord, GitHub URL, и т.д.)
│
└─ 0003_partner_contract.py ─► НОВАЯ! Добавляет contract field ⭐
   └─ ALTER TABLE core_partner ADD COLUMN contract
```

---

## 📈 СИСТЕМА УРОВНЕЙ (Activity Levels) ⭐

```
                       LEGEND 👑
                      (1000+pts)
                         │
                    ┌────┴────┐
                    │          │
                 EXPERT ⭐     │
              (500-1000pts)   │
                    │         │
                ┌───┴───┐     │
                │       │     │
            ADVANCED 🚀  │     │
           (200-500pts)  │     │
                │        │     │
            ┌───┴───┐    │     │
            │       │    │     │
       INTERMEDIATE 🔥   │     │
        (50-200pts)      │     │
            │            │     │
        ┌───┴────┐       │     │
        │        │       │     │
    BEGINNER 🍃  │       │     │
    (0-50pts)    │       │     │
        │        │       │     │
        └────────┴───────┴─────┘
             ОЧКИ СЧИТАЮТСЯ:
        📝 Post: +10
        💬 Comment: +1
        👍 Like (received): +2
```

---

## 🎯 ОСНОВНЫЕ КОМПОНЕНТЫ

```
┌─────────────────────────────────────────────┐
│         BASE TEMPLATE (base.html)           │
│  ┌─────────────────────────────────────┐   │
│  │ NAVBAR (Bootstrap)                  │   │
│  │ [Logo] [Nav Items] [Auth Buttons]   │   │
│  └─────────────────────────────────────┘   │
│  ┌─────────────────────────────────────┐   │
│  │ {% block content %}                 │   │
│  │ CHILD TEMPLATES                     │   │
│  │ (post_list, profile, gallery, ...)  │   │
│  │ {% endblock %}                      │   │
│  └─────────────────────────────────────┘   │
│  ┌─────────────────────────────────────┐   │
│  │ FOOTER                              │   │
│  │ [Logo] [Links] [Copyright]          │   │
│  └─────────────────────────────────────┘   │
└─────────────────────────────────────────────┘
```

---

## 📊 СТАТИСТИКА ПРОЕКТА

```
🗂️ СТРУКТУРА:
  5 Django Apps
  9 Models
  20+ Templates
  30+ Views
  1500+ CSS lines

📦 ЗАВИСИМОСТИ:
  Django 5.2.9
  Bootstrap 5.3.3
  HTMX 1.9.12
  FontAwesome 6.5.2
  CKEditor 5

💾 БД:
  SQLite
  28 Migrations
  26+ Test Records
  7 Tables

📚 ДОКУМЕНТАЦИЯ:
  12 Files
  100+ Pages
  40+ Hours

✅ ФУНКЦИИ:
  ✅ User Management
  ✅ Activity Levels ⭐
  ✅ Blog
  ✅ Partners with Contracts ⭐
  ✅ Products
  ✅ Gallery
  ✅ Admin Panel
```

---

## 🚀 ПУТЬ ПОЛЬЗОВАТЕЛЯ (User Journey)

```
1. DISCOVERY
   └─► Открыть http://localhost:8000

2. REGISTRATION
   └─► Зарегистрироваться через форму

3. PROFILE SETUP
   └─► Заполнить профиль, загрузить аватар

4. EXPLORATION
   ├─► Посмотреть партнеров
   ├─► Посмотреть посты
   ├─► Посмотреть товары
   └─► Посмотреть галерею

5. ENGAGEMENT
   ├─► Создать пост (+10 очков)
   ├─► Комментировать посты (+1 очко)
   ├─► Лайкировать посты (+2 очков)
   └─► Смотреть свой уровень расти

6. ACHIEVEMENT
   ├─► Достичь Intermediate (50 pts)
   ├─► Достичь Advanced (200 pts)
   ├─► Достичь Expert (500 pts)
   └─► Достичь Legend (1000 pts)

7. COMMUNITY
   └─► Видеть уровни других пользователей
       └─► Мотивация к активности
```

---

## 🎯 КЛЮЧЕВЫЕ УЛУЧШЕНИЯ V1.0

```
✨ ПЕРЕД              VS              ПОСЛЕ
──────────────                    ──────────────
Skip link            ─► ❌ УДАЛЕН
Partners (basic)     ─► 🎨 REDESIGNED (gradients)
No contracts         ─► 📄 ADDED (with storage) ⭐
No activity levels   ─► 🎖️ 5 LEVELS (Beginner→Legend) ⭐
Levels not visible   ─► 👁️ VISIBLE ON PROFILE ⭐
No explanation       ─► 📖 INFO PAGE ⭐
Popovers broken      ─► ✅ FIXED
```

---

**Версия:** 1.0 | **Дата:** 28 декабря 2025 | **Статус:** ✅ Визуальная карта полная
