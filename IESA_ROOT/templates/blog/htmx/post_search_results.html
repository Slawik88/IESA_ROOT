{% if not results.posts and not results.events and not results.partners and not results.users %}
  <div class="text-muted small">No results.</div>
{% else %}
  <style>
    @keyframes fadeInSmall { from { opacity:0; transform: translateY(6px); } to { opacity:1; transform: translateY(0); } }
    .hx-item { animation: fadeInSmall .28s ease both; }
    mark {
      background-color: #fff3cd;
      color: #333;
      font-weight: 500;
      padding: 1px 3px;
      border-radius: 2px;
    }
  </style>
  <div class="list-group">

    {% if results.users %}
      {% for item in results.users %}
        {% with user=item.user %}
        <a href="{% url 'profile_public_username' username=user.username %}" class="list-group-item list-group-item-action d-flex align-items-center py-2 hx-item" style="animation-delay: calc({{ forloop.counter0 }} * 22ms);">
            {% if user.avatar %}
                <img src="{{ user.avatar.url }}" style="width:36px; height:36px; object-fit:cover; border-radius:50%; margin-right:12px;" alt="{{ user.username }}">
            {% else %}
                <div class="bg-primary text-white d-flex align-items-center justify-content-center fw-bold" style="width:36px; height:36px; border-radius:50%; margin-right:12px; font-size:0.9rem;">{{ user.username|slice:":1"|upper }}</div>
            {% endif %}
            <div class="flex-grow-1">
                <strong>{{ user.get_full_name|default:user.username }}</strong>
                <span class="text-muted ms-2">@{{ item.username_html|safe }}</span>
                <br>
                <small class="text-muted">{{ item.email_html|safe }}</small>
            </div>
        </a>
        {% endwith %}
      {% endfor %}
    {% endif %}

    {% for item in results.posts %}
      {% with post=item.post %}
      <a href="{{ post.get_absolute_url }}" class="list-group-item list-group-item-action hx-item" style="animation-delay: calc({{ forloop.counter0 }} * 22ms);">
        <div class="d-flex w-100 justify-content-between">
          <h6 class="mb-1 small">{{ item.title_html|safe }}</h6>
          <small class="text-muted">{{ post.created_at|date:"M d, Y" }}</small>
        </div>
        <p class="mb-1 small text-truncate text-muted">{{ post.text|striptags|truncatechars:120 }}</p>
      </a>
      {% endwith %}
    {% endfor %}

    {% for item in results.events %}
      {% with event=item.event %}
      <a href="{% url 'event_detail' pk=event.pk %}" class="list-group-item list-group-item-action hx-item" style="animation-delay: calc({{ forloop.counter0 }} * 22ms);">
        <div class="d-flex w-100 justify-content-between">
          <h6 class="mb-1 small">[Event] {{ item.title_html|safe }}</h6>
          <small class="text-muted">{{ event.date|date:"M d, Y" }}</small>
        </div>
        <p class="mb-1 small text-truncate text-muted">{{ event.description|striptags|truncatechars:120 }}</p>
      </a>
      {% endwith %}
    {% endfor %}

    {% for item in results.partners %}
      {% with partner=item.partner %}
      <a href="#" hx-get="{% url 'partner_detail' pk=partner.pk %}" hx-target="#partner-modal-body" data-bs-toggle="modal" data-bs-target="#partnerModal" data-partner-name="{{ partner.name }}" class="list-group-item list-group-item-action partner-result hx-item" style="animation-delay: calc({{ forloop.counter0 }} * 22ms);">
        <div class="d-flex w-100 justify-content-between">
          <h6 class="mb-1 small">[Partner] {{ item.name_html|safe }}</h6>
        </div>
        <p class="mb-1 small text-truncate text-muted">{{ partner.description|striptags|truncatechars:120 }}</p>
      </a>
      {% endwith %}
    {% endfor %}
  </div>
{% endif %}
