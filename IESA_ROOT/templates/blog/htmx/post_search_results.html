{% if not results.posts and not results.events and not results.partners and not results.users %}
  <div class="text-muted small">No results.</div>
{% else %}
  <style>
    @keyframes fadeInSmall { from { opacity:0; transform: translateY(6px); } to { opacity:1; transform: translateY(0); } }
    .hx-item { animation: fadeInSmall .28s ease both; border: 1px solid #eef1f7; margin-bottom: 6px; border-radius: 10px; padding: 10px 12px; }
    .hx-item:hover { background: #f6f8ff; border-color: #dbe4ff; }
    .hx-type { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.08em; color: #5c6c94; }
    mark { background-color: #fff3cd; color: #333; font-weight: 500; padding: 1px 3px; border-radius: 2px; }
  </style>
  <div class="list-group border-0">

    {% if results.users %}
      {% for item in results.users %}
        {% with user=item.user %}
        <a href="{% url 'profile_public_username' username=user.username %}" class="list-group-item list-group-item-action d-flex align-items-center hx-item" style="animation-delay: calc({{ forloop.counter0 }} * 22ms);">
            {% if user.avatar and user.avatar.name != 'avatars/default.png' %}
              <span class="avatar avatar-sm me-3"><img src="{{ user.avatar.url }}" alt="{{ user.username }}"></span>
            {% else %}
              <span class="avatar avatar-sm avatar-fallback me-3">{{ user.username|slice:":1"|upper }}</span>
            {% endif %}
            <div class="flex-grow-1">
                <div class="d-flex align-items-center gap-2">
                    <strong>{{ user.get_full_name|default:user.username }}</strong>
                    <span class="hx-type">User</span>
                </div>
                <small class="text-muted">@{{ item.username_html|safe }} Â· {{ item.email_html|safe }}</small>
            </div>
        </a>
        {% endwith %}
      {% endfor %}
    {% endif %}

    {% for item in results.posts %}
      {% with post=item.post %}
      <a href="{{ post.get_absolute_url }}" class="list-group-item list-group-item-action hx-item" style="animation-delay: calc({{ forloop.counter0 }} * 22ms);">
        <div class="d-flex w-100 justify-content-between align-items-center">
          <div class="d-flex align-items-center gap-2">
            <span class="hx-type">Post</span>
            <h6 class="mb-0 small">{{ item.title_html|safe }}</h6>
          </div>
          <small class="text-muted">{{ post.created_at|date:"M d, Y" }}</small>
        </div>
        <p class="mb-1 small text-truncate text-muted">{{ post.text|striptags|truncatechars:120 }}</p>
      </a>
      {% endwith %}
    {% endfor %}

    {% for item in results.events %}
      {% with event=item.event %}
      <a href="{% url 'event_detail' pk=event.pk %}" class="list-group-item list-group-item-action hx-item" style="animation-delay: calc({{ forloop.counter0 }} * 22ms);">
        <div class="d-flex w-100 justify-content-between align-items-center">
          <div class="d-flex align-items-center gap-2">
            <span class="hx-type">Event</span>
            <h6 class="mb-0 small">{{ item.title_html|safe }}</h6>
          </div>
          <small class="text-muted">{{ event.date|date:"M d, Y" }}</small>
        </div>
        <p class="mb-1 small text-truncate text-muted">{{ event.description|striptags|truncatechars:120 }}</p>
      </a>
      {% endwith %}
    {% endfor %}

    {% for item in results.partners %}
      {% with partner=item.partner %}
      <a href="#" hx-get="{% url 'partner_detail' pk=partner.pk %}" hx-target="#partner-modal-body" data-bs-toggle="modal" data-bs-target="#partnerModal" data-partner-name="{{ partner.name }}" class="list-group-item list-group-item-action partner-result hx-item" style="animation-delay: calc({{ forloop.counter0 }} * 22ms);">
        <div class="d-flex w-100 justify-content-between align-items-center">
          <div class="d-flex align-items-center gap-2">
            <span class="hx-type">Partner</span>
            <h6 class="mb-0 small">{{ item.name_html|safe }}</h6>
          </div>
        </div>
        <p class="mb-1 small text-truncate text-muted">{{ partner.description|striptags|truncatechars:120 }}</p>
      </a>
      {% endwith %}
    {% endfor %}
  </div>
{% endif %}
