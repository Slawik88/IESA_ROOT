{% if query %}
    <div class="search-results">
        <style>
            @keyframes fadeInSmall { from { opacity:0; transform: translateY(6px); } to { opacity:1; transform: translateY(0); } }
            .hx-item { animation: fadeInSmall .28s ease both; }
        </style>
        <!-- Users Results -->
        {% if results.users %}
        <div class="mb-4">
            <h6 class="text-muted fw-bold mb-2">
                <i class="fas fa-users me-2"></i>Users ({{ results.users|length }})
            </h6>
            <div class="list-group">
                     {% for user in results.users %}
                     <a href="{% url 'profile_public_username' username=user.username %}" 
                         class="list-group-item list-group-item-action d-flex align-items-center py-2 hx-item" style="animation-delay: calc({{ forloop.counter0 }} * 28ms);">
                    {% if user.avatar %}
                        <img src="{{ user.avatar.url }}" 
                             style="width:36px; height:36px; object-fit:cover; border-radius:50%; margin-right:12px;" 
                             alt="{{ user.username }}">
                    {% else %}
                        <div class="bg-primary text-white d-flex align-items-center justify-content-center fw-bold"
                             style="width:36px; height:36px; border-radius:50%; margin-right:12px; font-size:0.9rem;">
                            {{ user.username|slice:":1"|upper }}
                        </div>
                    {% endif %}
                    <div class="flex-grow-1">
                        <strong>{{ user.get_full_name|default:user.username }}</strong>
                        <span class="text-muted ms-2">@{{ user.username }}</span>
                        <br>
                        <small class="text-muted">{{ user.email }}</small>
                    </div>
                </a>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Posts Results -->
        {% if results.posts %}
        <div class="mb-4">
            <h6 class="text-muted fw-bold mb-2">
                <i class="fas fa-file-alt me-2"></i>Posts ({{ results.posts|length }})
            </h6>
            <div class="list-group">
                {% for post in results.posts %}
                <a href="{% url 'post_detail' pk=post.pk %}" class="list-group-item list-group-item-action">
                    <div class="d-flex w-100 justify-content-between align-items-start">
                        <div class="flex-grow-1">
                            <h6 class="mb-1">{{ post.title }}</h6>
                            <p class="mb-1 text-muted small" style="max-height: 2em; overflow: hidden;">
                                {{ post.text|truncatewords:15|striptags }}
                            </p>
                            <small class="text-muted">
                                <i class="fas fa-user-circle me-1"></i>{{ post.author.username }} • 
                                <i class="fas fa-calendar-alt me-1"></i>{{ post.created_at|date:"d M Y" }}
                            </small>
                        </div>
                        <small class="text-muted ms-2">
                            <i class="fas fa-eye me-1"></i>{{ post.views_count }}
                        </small>
                    </div>
                </a>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Events Results -->
        {% if results.events %}
        <div class="mb-4">
            <h6 class="text-muted fw-bold mb-2">
                <i class="fas fa-calendar-check me-2"></i>Events ({{ results.events|length }})
            </h6>
            <div class="list-group">
                {% for event in results.events %}
                <a href="{% url 'event_detail' pk=event.pk %}" class="list-group-item list-group-item-action">
                    <h6 class="mb-1">{{ event.title }}</h6>
                    <small class="text-muted">
                        <i class="fas fa-map-marker-alt me-1"></i>{{ event.location }} • 
                        <i class="fas fa-clock me-1"></i>{{ event.date|date:"d M Y, H:i" }}
                    </small>
                </a>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Partners Results -->
        {% if results.partners %}
        <div class="mb-4">
            <h6 class="text-muted fw-bold mb-2">
                <i class="fas fa-handshake me-2"></i>Partners ({{ results.partners|length }})
            </h6>
            <div class="list-group">
                {% for partner in results.partners %}
                <a href="#" class="list-group-item list-group-item-action">
                    <h6 class="mb-1">{{ partner.name }}</h6>
                    <small class="text-muted">{{ partner.description|truncatewords:10 }}</small>
                </a>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- No results message -->
        {% if not results.users and not results.posts and not results.events and not results.partners %}
        <div class="text-muted text-center py-4">
            <i class="fas fa-search fa-2x mb-2" style="opacity:0.5;"></i>
            <p>No results found for "{{ query }}"</p>
        </div>
        {% endif %}
    </div>
{% else %}
    <div class="text-muted small text-center py-3">
        <i class="fas fa-search me-2"></i>Type to search...
    </div>
{% endif %}
